	<section class="py-2 sm:py-4">
	<div class="ui-card rounded-2xl p-5 sm:p-7">
		<div class="flex items-start justify-between gap-4">
			<div>
				<h1 class="text-3xl font-semibold tracking-tight">Medya</h1>
				<p class="ui-muted mt-3">
					Sitede görünen görselleri buradan güncelleyebilirsin.
					En kolay yöntem: dosyayı seçip yüklemek.
				</p>
			</div>
			<% if (query && query.err) { %>
				<%
					const errMap = {
						file_too_large: 'Dosya çok büyük. Maksimum boyut: 10MB.',
						invalid_file_type: 'Sadece görsel dosyaları yükleyebilirsiniz.',
						upload_error: 'Dosya yüklenirken bir sorun oluştu.',
					};
					const errMsg = errMap[String(query.err)] || 'Bir hata oluştu. Lütfen tekrar deneyin.';
				%>
				<div class="rounded-xl border ui-border px-4 py-2 bg-[color:var(--bg-elevated)] text-sm"><%= errMsg %></div>
			<% } %>
			<% if (query && query.ok) { %>
				<div class="rounded-xl border ui-border px-4 py-2 bg-[color:var(--bg-elevated)] text-sm">Kaydedildi.</div>
			<% } %>
		</div>
	</div>

	<div class="mt-6 grid lg:grid-cols-2 gap-6">
		<div class="ui-card rounded-2xl p-5 sm:p-7">
			<h2 class="text-xl font-semibold">Sabit Görseller</h2>
			<p class="ui-muted mt-2 text-sm">Ana sayfa kapak, hizmetler küçük görseli, iletişim sayfası görseli gibi alanlar.</p>

			<div class="mt-5 grid gap-4">
				<%
					const slotEntries = (media && media.slots) ? Object.entries(media.slots) : [];
					const slotLabels = {
						'home.heroBackground': 'Ana Sayfa Kapak Görseli',
						'about.hero': 'Hakkımızda Görseli',
						'services.menThumb': 'Hizmetler (Kuaför) Küçük Görsel',
						'services.womenThumb': 'Hizmetler (Güzellik) Küçük Görsel',
						'booking.chooseHero': 'Randevu Sayfası Görseli',
						'booking.indexHero': 'Randevu (Adımlar) Görseli',
					};
					slotEntries
						.filter(([key]) => key !== 'home.mapPlaceholder' && !key.startsWith('contact.'))
						.sort((a, b) => a[0].localeCompare(b[0]))
						.forEach(([key, slot]) => {
				%>
					<form class="rounded-xl border ui-border p-4 bg-[color:var(--bg-elevated)]" action="<%= (adminBasePath || '') + '/medya/slot' %>" method="post" enctype="multipart/form-data">
						<div class="flex items-start justify-between gap-3">
							<div>
								<p class="font-semibold"><%= slotLabels[key] || 'Görsel Alanı' %></p>
								<p class="text-xs ui-muted mt-1">Kod: <span class="font-medium"><%= key %></span></p>
								<p class="text-xs ui-muted mt-1">Önerilen: <span class="font-medium"><%= slot.recommended || '-' %></span></p>
							</div>
							<button class="ui-btn ui-btn-primary text-sm px-3 py-2" type="submit">Kaydet</button>
						</div>

						<input type="hidden" name="key" value="<%= key %>" />

						<div class="mt-3 grid sm:grid-cols-2 gap-3 items-start">
							<div>
								<img src="<%= slot.src %>" alt="<%= slot.alt || '' %>" class="w-full aspect-video object-cover rounded-xl border ui-border" />
								<p class="mt-2 text-xs ui-muted break-all">Mevcut dosya/link: <%= slot.src %></p>
							</div>

							<div class="grid gap-2">
								<label class="text-sm">
									<span class="ui-muted">Alt</span>
									<input name="alt" value="<%= slot.alt || '' %>" class="mt-1 w-full rounded-xl px-3 py-2 border ui-border bg-[color:var(--bg-elevated)]" />
								</label>

								<label class="text-sm">
									<span class="ui-muted">Görsel Linki (isteğe bağlı)</span>
									<input name="src" value="<%= slot.src || '' %>" class="mt-1 w-full rounded-xl px-3 py-2 border ui-border bg-[color:var(--bg-elevated)]" />
									<p class="mt-1 text-xs ui-muted">Dosya yüklemek istemezsen link yapıştırabilirsin.</p>
								</label>

								<label class="text-sm">
									<span class="ui-muted">Yeni Dosya (isteğe bağlı)</span>
									<input name="file" type="file" accept="image/*" class="mt-1 w-full text-sm" />
								</label>
							</div>
						</div>
					</form>
				<% }) %>
			</div>
		</div>

		<div class="ui-card rounded-2xl p-5 sm:p-7">
			<h2 class="text-xl font-semibold">Galeri</h2>
			<p class="ui-muted mt-2 text-sm">Önerilen: 1280×720 veya daha büyük, yatay (16:9).</p>

			<form class="mt-5 rounded-xl border ui-border p-4 bg-[color:var(--bg-elevated)]" action="<%= (adminBasePath || '') + '/medya/galeri' %>" method="post" enctype="multipart/form-data">
				<div class="flex items-start justify-between gap-3">
					<p class="font-semibold">Yeni görsel ekle</p>
					<button class="ui-btn ui-btn-primary text-sm px-3 py-2" type="submit">Ekle</button>
				</div>
				<div class="mt-3 grid sm:grid-cols-2 gap-3">
					<label class="text-sm">
						<span class="ui-muted">Kategori</span>
						<select name="category" class="mt-1 w-full rounded-xl px-3 py-2 border ui-border bg-[color:var(--bg-elevated)]">
							<option value="both">Her ikisi</option>
							<option value="men">Erkek Kuaförü</option>
							<option value="women">Güzellik Salonu</option>
						</select>
					</label>
					<label class="text-sm">
						<span class="ui-muted">Alt</span>
						<input name="alt" class="mt-1 w-full rounded-xl px-3 py-2 border ui-border bg-[color:var(--bg-elevated)]" placeholder="Görsel açıklaması (isteğe bağlı)" />
					</label>
					<label class="text-sm">
						<span class="ui-muted">Görsel Linki (isteğe bağlı)</span>
						<input name="src" class="mt-1 w-full rounded-xl px-3 py-2 border ui-border bg-[color:var(--bg-elevated)]" placeholder="(Boş bırakıp dosya yükleyebilirsin)" />
					</label>
					<label class="text-sm sm:col-span-2">
						<span class="ui-muted">Dosya (isteğe bağlı)</span>
						<input name="file" type="file" accept="image/*" class="mt-1 w-full text-sm" />
					</label>
				</div>
			</form>

			<div class="mt-5 grid gap-4">
				<% (media && Array.isArray(media.gallery) ? media.gallery : []).forEach((it) => { %>
					<div class="rounded-xl border ui-border p-4 bg-[color:var(--bg-elevated)]">
						<div class="flex items-start justify-between gap-3">
							<div>
								<p class="font-semibold">Kayıt No: <%= it.id %></p>
								<p class="mt-1 text-xs ui-muted break-all">Dosya/link: <%= it.src %></p>
							</div>
							<form action="<%= (adminBasePath || '') + '/medya/galeri/' + it.id + '/sil' %>" method="post">
								<button class="ui-btn ui-btn-ghost text-sm px-3 py-2" type="submit">Sil</button>
							</form>
						</div>

						<div class="mt-3 grid sm:grid-cols-2 gap-3 items-start">
							<img src="<%= it.src %>" alt="<%= it.alt || '' %>" class="w-full aspect-video object-cover rounded-xl border ui-border" />

							<form action="<%= (adminBasePath || '') + '/medya/galeri/' + it.id %>" method="post" enctype="multipart/form-data" class="grid gap-2">
								<label class="text-sm">
									<span class="ui-muted">Kategori</span>
									<select name="category" class="mt-1 w-full rounded-xl px-3 py-2 border ui-border bg-[color:var(--bg-elevated)]">
										<option value="both" <%= (it.category || 'both') === 'both' ? 'selected' : '' %>>Her ikisi</option>
										<option value="men" <%= (it.category || 'both') === 'men' ? 'selected' : '' %>>Erkek Kuaförü</option>
										<option value="women" <%= (it.category || 'both') === 'women' ? 'selected' : '' %>>Güzellik Salonu</option>
									</select>
								</label>
								<label class="text-sm">
									<span class="ui-muted">Alt</span>
									<input name="alt" value="<%= it.alt || '' %>" class="mt-1 w-full rounded-xl px-3 py-2 border ui-border bg-[color:var(--bg-elevated)]" />
								</label>

								<label class="text-sm">
									<span class="ui-muted">Görsel Linki (isteğe bağlı)</span>
									<input name="src" value="<%= it.src || '' %>" class="mt-1 w-full rounded-xl px-3 py-2 border ui-border bg-[color:var(--bg-elevated)]" />
								</label>

								<label class="text-sm">
									<span class="ui-muted">Yeni Dosya (isteğe bağlı)</span>
									<input name="file" type="file" accept="image/*" class="mt-1 w-full text-sm" />
								</label>

								<button class="ui-btn ui-btn-primary text-sm px-3 py-2 mt-1" type="submit">Güncelle</button>
							</form>
						</div>
					</div>
				<% }) %>
			</div>
		</div>
	</div>
	</section>
