<header class="sticky top-0 z-50 border-b ui-border bg-[color:var(--bg-primary)]/85 backdrop-blur" data-mobile-nav-root>
	<div class="max-w-7xl mx-auto px-4 sm:px-6 py-3 flex items-center justify-between gap-3 lg:grid lg:grid-cols-[auto_1fr_auto] lg:items-center">
		<a href="/" class="flex items-center justify-start shrink-0 min-w-0 max-w-[165px] sm:max-w-[195px]" aria-label="Ana sayfa">
			<img src="/public/logo/logo.jpg" alt="Logo" class="h-8 sm:h-10 w-auto max-w-full max-h-12 object-contain" />
		</a>

		<nav class="hidden lg:flex items-center justify-center gap-6 text-sm whitespace-nowrap">
			<a class="ui-muted hover:underline" href="/">Anasayfa</a>
			<a class="ui-muted hover:underline" href="/products">Ürünler</a>
			<a class="ui-muted hover:underline" href="/track">Sipariş Takibi</a>
			<a class="ui-muted hover:underline" href="/iletisim">İletişim</a>
		</nav>

		<div class="flex items-center justify-end gap-2 sm:gap-3 shrink-0">
			<details class="relative hidden lg:block">
				<summary class="ui-btn ui-btn-ghost p-2" aria-label="Ürün ara">
					<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" class="h-5 w-5" aria-hidden="true">
						<path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-4.35-4.35m1.1-5.15a7 7 0 11-14 0 7 7 0 0114 0z" />
					</svg>
				</summary>
				<div class="absolute right-0 mt-2 w-80 rounded-lg border ui-border bg-[color:var(--bg-primary)] shadow-lg p-3">
					<form method="get" action="<%= (typeof searchPath === 'string' && searchPath) ? searchPath : '/products' %>" class="flex items-center gap-2">
						<input
							name="q"
							type="search"
							placeholder="Ürün ara..."
							value="<%= (typeof filters !== 'undefined' && filters && filters.q) ? filters.q : '' %>"
							class="w-full border ui-border bg-[color:var(--bg-elevated)] rounded px-3 py-2"
						/>
						<button type="submit" class="ui-btn ui-btn-primary px-3 py-2">Ara</button>
					</form>
				</div>
			</details>

			<% if (isShopLoggedIn) { %>
				<a class="ui-btn ui-btn-ghost p-2" href="/account" aria-label="Hesabım">
					<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" class="h-5 w-5" aria-hidden="true">
						<path stroke-linecap="round" stroke-linejoin="round" d="M20 21a8 8 0 10-16 0" />
						<path stroke-linecap="round" stroke-linejoin="round" d="M12 13a4 4 0 100-8 4 4 0 000 8z" />
					</svg>
				</a>
			<% } else { %>
				<a class="ui-btn ui-btn-ghost p-2" href="/login" aria-label="Giriş Yap">
					<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" class="h-5 w-5" aria-hidden="true">
						<path stroke-linecap="round" stroke-linejoin="round" d="M20 21a8 8 0 10-16 0" />
						<path stroke-linecap="round" stroke-linejoin="round" d="M12 13a4 4 0 100-8 4 4 0 000 8z" />
					</svg>
				</a>
			<% } %>

			<a class="ui-btn ui-btn-ghost p-2 relative" href="/cart" aria-label="Sepet">
				<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" class="h-5 w-5" aria-hidden="true">
					<path stroke-linecap="round" stroke-linejoin="round" d="M6 6h15l-1.5 9h-12z" />
					<path stroke-linecap="round" stroke-linejoin="round" d="M6 6l-2-2H2" />
					<path stroke-linecap="round" stroke-linejoin="round" d="M9 20a1 1 0 100-2 1 1 0 000 2zM18 20a1 1 0 100-2 1 1 0 000 2z" />
				</svg>
				<% const cc = (typeof cartCount === 'number' && cartCount > 0) ? cartCount : 0; %>
				<% if (cc) { %>
					<span class="absolute -top-1 -right-1 min-w-[18px] h-[18px] px-1 rounded-full bg-[color:var(--accent)] text-[color:var(--accent-contrast)] text-[11px] leading-[18px] text-center font-semibold"><%= cc %></span>
				<% } %>
			</a>

			<button
				type="button"
				class="lg:hidden ui-btn ui-btn-ghost px-3 py-2"
				data-mobile-nav-toggle
				aria-expanded="false"
				aria-label="Menü"
			>
				<span class="hamburger" aria-hidden="true">
					<span class="hamburger-line"></span>
					<span class="hamburger-line"></span>
					<span class="hamburger-line"></span>
				</span>
			</button>
		</div>
	</div>

	<div class="lg:hidden border-t ui-border mobile-nav-panel" data-mobile-nav-panel data-open="false">
		<div class="max-w-7xl mx-auto px-4 sm:px-6 py-4 flex flex-col gap-4 text-sm">
			<div class="flex flex-col gap-2">
				<a class="ui-muted hover:underline py-1" href="/">Anasayfa</a>
				<a class="ui-muted hover:underline py-1" href="/products">Ürünler</a>
				<a class="ui-muted hover:underline py-1" href="/track">Sipariş Takibi</a>
				<a class="ui-muted hover:underline py-1" href="/iletisim">İletişim</a>
			</div>

			<form method="get" action="<%= (typeof searchPath === 'string' && searchPath) ? searchPath : '/products' %>" class="flex items-center gap-3">
				<input
					name="q"
					type="search"
					placeholder="Ürün ara..."
					value="<%= (typeof filters !== 'undefined' && filters && filters.q) ? filters.q : '' %>"
					class="w-full border ui-border bg-[color:var(--bg-elevated)] rounded px-3 py-2"
				/>
				<button type="submit" class="ui-muted hover:underline">Ara</button>
			</form>

			<% const mobileCartCount = (typeof cartCount === 'number' && cartCount > 0) ? cartCount : 0; %>
			<div class="grid grid-cols-2 gap-3">
				<% if (isShopLoggedIn) { %>
					<a class="ui-btn ui-btn-ghost px-3 py-2 inline-flex items-center justify-center gap-2" href="/account" aria-label="Hesabım">
						<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" class="h-5 w-5" aria-hidden="true">
							<path stroke-linecap="round" stroke-linejoin="round" d="M20 21a8 8 0 10-16 0" />
							<path stroke-linecap="round" stroke-linejoin="round" d="M12 13a4 4 0 100-8 4 4 0 000 8z" />
						</svg>
						<span>Hesabım</span>
					</a>
				<% } else { %>
					<a class="ui-btn ui-btn-ghost px-3 py-2 inline-flex items-center justify-center gap-2" href="/login" aria-label="Giriş Yap">
						<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" class="h-5 w-5" aria-hidden="true">
							<path stroke-linecap="round" stroke-linejoin="round" d="M20 21a8 8 0 10-16 0" />
							<path stroke-linecap="round" stroke-linejoin="round" d="M12 13a4 4 0 100-8 4 4 0 000 8z" />
						</svg>
						<span>Giriş</span>
					</a>
				<% } %>

				<a class="ui-btn ui-btn-ghost px-3 py-2 inline-flex items-center justify-center gap-2 relative" href="/cart" aria-label="Sepet">
					<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" class="h-5 w-5" aria-hidden="true">
						<path stroke-linecap="round" stroke-linejoin="round" d="M6 6h15l-1.5 9h-12z" />
						<path stroke-linecap="round" stroke-linejoin="round" d="M6 6l-2-2H2" />
						<path stroke-linecap="round" stroke-linejoin="round" d="M9 20a1 1 0 100-2 1 1 0 000 2zM18 20a1 1 0 100-2 1 1 0 000 2z" />
					</svg>
					<span>Sepet</span>
					<% if (mobileCartCount) { %>
						<span class="absolute -top-1 -right-1 min-w-[18px] h-[18px] px-1 rounded-full bg-[color:var(--accent)] text-[color:var(--accent-contrast)] text-[11px] leading-[18px] text-center font-semibold"><%= mobileCartCount %></span>
					<% } %>
				</a>
			</div>

			<div class="flex flex-col gap-2">
				<% if (isShopLoggedIn) { %>
					<a class="ui-muted hover:underline py-1" href="/orders">Siparişlerim</a>
					<form method="post" action="/logout" class="pt-1">
						<button type="submit" class="ui-muted hover:underline text-left py-1">Çıkış</button>
					</form>
				<% } else { %>
					<a class="ui-muted hover:underline py-1" href="/register">Kayıt Ol</a>
				<% } %>
			</div>
		</div>
	</div>
</header>
